// Code generated by goa v3.8.4, DO NOT EDIT.
//
// ProgLog gRPC client
//
// Command:
// $ goa gen proglog/design

package client

import (
	"context"
	prog_logpb "proglog/gen/grpc/prog_log/pb"
	proglog "proglog/gen/prog_log"
	proglogviews "proglog/gen/prog_log/views"

	goagrpc "goa.design/goa/v3/grpc"
	goa "goa.design/goa/v3/pkg"
	"google.golang.org/grpc"
)

// Client lists the service endpoint gRPC clients.
type Client struct {
	grpccli prog_logpb.ProgLogClient
	opts    []grpc.CallOption
}

// ProcedureStreamClientStream implements the
// proglog.ProcedureStreamClientStream interface.
type ProcedureStreamClientStream struct {
	stream prog_logpb.ProgLog_ProcedureStreamClient
	view   string
}

// ConsumeStreamClientStream implements the proglog.ConsumeStreamClientStream
// interface.
type ConsumeStreamClientStream struct {
	stream prog_logpb.ProgLog_ConsumeStreamClient
	view   string
}

// NewClient instantiates gRPC client for all the ProgLog service servers.
func NewClient(cc *grpc.ClientConn, opts ...grpc.CallOption) *Client {
	return &Client{
		grpccli: prog_logpb.NewProgLogClient(cc),
		opts:    opts,
	}
}

// Procedure calls the "Procedure" function in prog_logpb.ProgLogClient
// interface.
func (c *Client) Procedure() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildProcedureFunc(c.grpccli, c.opts...),
			EncodeProcedureRequest,
			DecodeProcedureResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goa.Fault(err.Error())
		}
		return res, nil
	}
}

// Consume calls the "Consume" function in prog_logpb.ProgLogClient interface.
func (c *Client) Consume() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildConsumeFunc(c.grpccli, c.opts...),
			EncodeConsumeRequest,
			DecodeConsumeResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goa.Fault(err.Error())
		}
		return res, nil
	}
}

// ProcedureStream calls the "ProcedureStream" function in
// prog_logpb.ProgLogClient interface.
func (c *Client) ProcedureStream() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildProcedureStreamFunc(c.grpccli, c.opts...),
			nil,
			DecodeProcedureStreamResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goa.Fault(err.Error())
		}
		return res, nil
	}
}

// ConsumeStream calls the "ConsumeStream" function in prog_logpb.ProgLogClient
// interface.
func (c *Client) ConsumeStream() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildConsumeStreamFunc(c.grpccli, c.opts...),
			nil,
			DecodeConsumeStreamResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goa.Fault(err.Error())
		}
		return res, nil
	}
}

// CloseAndRecv reads instances of "prog_logpb.ProcedureStreamResponse" from
// the "ProcedureStream" endpoint gRPC stream.
func (s *ProcedureStreamClientStream) CloseAndRecv() (*proglog.Produceresponse, error) {
	var res *proglog.Produceresponse
	v, err := s.stream.CloseAndRecv()
	if err != nil {
		return res, err
	}
	proj := NewProduceresponseView(v)
	vres := &proglogviews.Produceresponse{Projected: proj, View: "default"}
	if err := proglogviews.ValidateProduceresponse(vres); err != nil {
		return nil, err
	}
	return proglog.NewProduceresponse(vres), nil
}

// Send streams instances of "prog_logpb.ProcedureStreamStreamingRequest" to
// the "ProcedureStream" endpoint gRPC stream.
func (s *ProcedureStreamClientStream) Send(res *proglog.ProduceRequest) error {
	v := NewProtoProcedureStreamStreamingRequest(res)
	return s.stream.Send(v)
}

// Recv reads instances of "prog_logpb.ConsumeStreamResponse" from the
// "ConsumeStream" endpoint gRPC stream.
func (s *ConsumeStreamClientStream) Recv() (*proglog.Consumeresponse, error) {
	var res *proglog.Consumeresponse
	v, err := s.stream.Recv()
	if err != nil {
		return res, err
	}
	proj := NewConsumeresponseView(v)
	vres := &proglogviews.Consumeresponse{Projected: proj, View: "default"}
	if err := proglogviews.ValidateConsumeresponse(vres); err != nil {
		return nil, err
	}
	return proglog.NewConsumeresponse(vres), nil
}

// Send streams instances of "prog_logpb.ConsumeStreamStreamingRequest" to the
// "ConsumeStream" endpoint gRPC stream.
func (s *ConsumeStreamClientStream) Send(res *proglog.ConsumeRequest) error {
	v := NewProtoConsumeStreamStreamingRequest(res)
	return s.stream.Send(v)
}

func (s *ConsumeStreamClientStream) Close() error {
	// Close the send direction of the stream
	return s.stream.CloseSend()
}
